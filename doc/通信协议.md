# 通信协议

> 机器人端与主控台将以JSON格式数据进行信息通信。



## 基本消息格式

根据业务场景不同，整个软件过程会有多种消息类型（见下文）。对于不同的消息类型，将以全局的`type`字段来标识。除了`type`，基本的消息格式还规定了使用`code`（状态码）和`data`（数据）作为消息的携带信息。具体描述如下：

| 字段 | 类型   | 描述         | 默认值 |
| ---- | ------ | ------------ | ------ |
| type | int    | 标记消息类型 |        |
| code | long   | 业务状态码   | 0      |
| data | object | 业务数据     | null   |

* JSON格式

  ```javascript
  {
      type: 0,
  	code: 0x0001,
  	data: 
      	{
  			
  		}
  }
  ```

  

* 说明：对于不同的消息类型，除了必要的`type`、`code`和`data`字段外，还有可能根据业务场景的不同补充额外的字段。具体请查看**消息类型**部分



## 消息类型

通过对业务场景进行分析，现列出所有通信场景（实时更新）：

--------



### 0.响应消息

在业务场景结束或者流程中进行交互时，执行指令的一方通常需要在执行完成或者出现异常时将当前状态返回给另一方。这类型消息一般只需要返回一个状态码。

* 参数说明：

  * `type` : 0

  * `code` : 需要返回的状态码，一般情况下取**0（False）**和**1（True）**，具体取值请查看对应场景的文档描述

  * `data` : 消息携带的其他信息，当不需要时可赋值为null

    

* 例子：

  ```javascript
  {
      type: 0,
  	code: 0x00,
  	data: null
  }
  ```



###1.语音消息

这里的语音消息并不是语音类型的消息，而是机器人语音识别的结果消息，主要用于机器人通过语音识别的转换文本发送给主控台。

* 参数说明：

  * `type` : 1
  * `code` : 无意义，赋值为0即可
  * `data` ：**字符串**类型，转换的文本

* 例子：

  ```javascript
  {
      type: 1,
  	code: 0x00,
  	data: "你好，小优。"
  }
  ```

  

### 2.机器人动作指令消息

根据不同业务场景需要机器人做出不同的动作反馈，如语音播报，做手势等。主要用于主控台执行完指令后需要机器人做出反馈。

* 参数说明：

  * `type` : 2

  * `code` : 无意义，赋值为0即可

  * `data` ：**数组**类型，表示指令的集合。对于每个指令数据，参数说明如下：

    | 参数    | 类型   | 说明                 |
    | ------- | ------ | -------------------- |
    | command | int    | 指令类型（下面列出） |
    | data    | object | 指令携带数据         |

    下面列出全部已知的指令及其描述（实时更新）：

    | 动作     | 指令类型码（command） | 数据（data）                     | 说明     |
    | -------- | --------------------- | -------------------------------- | -------- |
    | 语音播报 | 0                     | 字符串类型，表示要播报的语音内容 | 播报语音 |
    | 指向屏幕 | 1                     | 整数类型，表示指向屏幕的时间     |          |

* 例子：

  ```javascript
  {
  	type: 2,
  	code: 0,
  	data: 
          [
              {
                  command: 0,
                  data: "好的，请看屏幕。"
              },
              {
                  command: 1,
                  data: 2
              }
          ]
  }
  ```

  